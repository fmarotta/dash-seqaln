{"version":3,"sources":["webpack:///./src/lib/components/DashSeqaln.react.js"],"names":["DashSeqaln","props","id","title","alignment","series","included","excluded","color_scheme","setProps","_props$allow_sequence","allow_sequence_selection","_props$show_letters","show_letters","_props$show_seqnum","show_seqnum","_props$zoom","zoom","highlightedRow","highlightedCol","labelRef","useRef","scaleRef","scrollViewPort","_useState","useState","_useState2","_slicedToArray","labelWidth","setLabelWidth","_useState3","_useState4","scaleWidth","setScaleWidth","_useState5","_useState6","scrollLeft","setScrollLeft","_useState7","_useState8","ticking","setTicking","useLayoutEffect","_labelRef$current$get","current","getBoundingClientRect","_scaleRef$current$get","React","createElement","className","setIncluded","items","map","x","name","setExcluded","setHighlighted","row","col","handleScroll","e","window","requestAnimationFrame","console","log","sequence_selection_component","Fragment","Seqselection","alignment_cumsum","useMemo","get_alignment_cumsum","alignment_colors","make_color_scheme","aln_breaks","i","Object","keys","length","push","String","ref","style","onScroll","seriesItem","key","label","make_series_scale","breaks","undefined","rescale_series","values","value","index","height","color","colSpan","seqId","seqIndex","split","letter","onClick","min","max","breaks_width","arguments","breaks_rescaled","concat","toFixed","scheme","seqIds","aln_length","colors","forEach","_loop","column","column_colors","color_msa_column","res","_i2","_Object$entries","entries","_Object$entries$_i","val","cumsum","_iterator","_createForOfIteratorHelper","_step","s","n","done","err","f","_ref","includedItems","make_sortablejs_items","excludedItems","ReactSortable","group","list","setList","item","l","selected","chosen","filtered","defaultProps","propTypes","PropTypes","string","object","array","number","func"],"mappings":"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","file":"2512f4e-main-wps-hmr.js","sourcesContent":["import React, { useState, useMemo, useRef, useLayoutEffect } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { ReactSortable } from 'react-sortablejs';\n\nimport { color_msa_column } from '../msa_color_schemes.js';\nimport './DashSeqaln.react.css';\n\n// NOTE: series values must be scaled between 0 and 1\n\n/**\n * ExampleComponent is an example component.\n */\nexport default function DashSeqaln(props) {\n  const {id, title, alignment, series, included, excluded, color_scheme, setProps} = props;\n  const {allow_sequence_selection = true, show_letters = true, show_seqnum = false, zoom = 10} = props;\n  const {highlightedRow, highlightedCol} = props;\n  const labelRef = useRef();\n  const scaleRef = useRef();\n  const scrollViewPort = useRef();\n  const [labelWidth, setLabelWidth] = useState(0);\n  const [scaleWidth, setScaleWidth] = useState(0);\n  const [scrollLeft, setScrollLeft] = useState(0);\n  const [ticking, setTicking] = useState(false);\n  useLayoutEffect(() => {\n    const { labelWidth } = labelRef.current.getBoundingClientRect();\n    const { scaleWidth } = scaleRef.current.getBoundingClientRect();\n    setLabelWidth(labelWidth);\n    setScaleWidth(scaleWidth);\n  }, []);\n  if (!alignment) {\n    return <div id={id} className=\"DashSeqaln\"></div>\n  }\n  // console.log(scrollViewPort.scrollLeft);\n  const setIncluded = (items) => {\n    setProps({included: items.map((x) => x.name)});\n  };\n  const setExcluded = (items) => {\n    setProps({excluded: items.map((x) => x.name)});\n  };\n  const setHighlighted = (row, col) => {\n    setProps({highlightedRow: row, highlightedCol: col});\n  };\n  const handleScroll = (e) => {\n    setScrollLeft(scrollViewPort.scrollLeft);\n    if (!ticking) {\n      window.requestAnimationFrame(() => {\n        console.log(scrollLeft)\n        console.log(scrollViewPort);\n        // doSomething(scrollLeft);\n        setTicking(false);\n      });\n      setTicking(true);\n    };\n  };\n  let sequence_selection_component = <></>;\n  if (allow_sequence_selection === true) {\n    sequence_selection_component = Seqselection({\n      id: id,\n      included: included,\n      excluded: excluded,\n      setIncluded: setIncluded,\n      setExcluded: setExcluded\n    });\n  }\n  const alignment_cumsum = useMemo(() => get_alignment_cumsum(alignment), [alignment]);\n  const alignment_colors = useMemo(() => make_color_scheme(alignment, color_scheme), [alignment, color_scheme]);\n  const aln_breaks = [];\n  for (let i = 0; i < alignment[Object.keys(alignment)[0]].length; i++) {\n    if (i % 10 === 0)\n      aln_breaks.push(String(i+1));\n    else\n      aln_breaks.push(\"\");\n  }\n  return (\n    <div id={id} className=\"DashSeqaln\">\n      {title && (<h2 className=\"title\">{title}</h2>)}\n      <div ref={scrollViewPort} style={{\"overflowX\": \"auto\"}} onScroll={(e) => handleScroll(e)} >\n      <table>\n        {series.map((seriesItem) => (\n          <thead key={\"series-\"+seriesItem.label} className=\"series\">\n          <tr>\n            <td className=\"series-label\">\n              {seriesItem.label}\n            </td>\n            <td className=\"series-scale\" style={{\"position\": \"sticky\", \"left\": labelWidth}}>\n              {make_series_scale(\"breaks\" in seriesItem ? seriesItem.breaks : undefined)}\n            </td>\n            {rescale_series(seriesItem.values, \"breaks\" in seriesItem ? seriesItem.breaks : undefined).map((value, index) => (\n              <td key={\"series-\"+index} className=\"series-values\" style={{\"height\": seriesItem.height || \"100px\"}}>\n                <div style={{\"backgroundColor\": seriesItem.color || \"black\", \"height\": (100 * value) + \"%\", \"position\": \"relative\"}}>\n                  <span className=\"series-values-tooltip\">{(index + 1) + \":\" + seriesItem.values[index]}</span>\n                </div>\n              </td>\n            ))}\n          </tr>\n          <tr><td colSpan=\"100%\" className=\"series-separator\"></td></tr>\n          </thead>\n        ))}\n      <tbody className=\"aln\">\n        <tr className=\"aln-axis\">\n          <td ref={labelRef} className=\"aln-axis-label\"></td>\n          <td ref={scaleRef} className=\"aln-axis-seqnum\"></td>\n          {aln_breaks.map((x, index) => (\n            <td key={\"aln-axis-resnum-\"+index} className=\"aln-axis-resnum\">\n              <span style={{\"width\": \"0px\", \"display\": \"block\"}}>{x}</span>\n            </td>\n          ))}\n        </tr>\n        {included.map((seqId, seqIndex) => (\n          <tr key={\"aln-\"+seqId} className={\"aln-row\" + (seqIndex === highlightedRow ? \" highlighted\" : \"\")}>\n            <td className=\"aln-label\">{seqId}</td>\n            <td className=\"aln-seqnum\">{show_seqnum ? seqIndex : \"\"}</td>\n            {alignment[seqId].split(\"\").map((letter, index) => (\n              <td\n                key={\"aln-\"+index}\n                className={\"aln-letter\" + (index === highlightedCol ? \" highlighted\" : \"\")}\n                style={{\"backgroundColor\": alignment_colors[seqId][index], \"minWidth\": zoom + \"px\", \"maxWidth\": zoom + \"px\"}}\n                onClick={() => {setHighlighted(seqIndex, index)}}\n              >\n                {show_letters ? letter : \"\"}\n                {letter !== \"-\" && (\n                  <span className=\"aln-letter-tooltip\">{seqId + \":\" + alignment_cumsum[seqId][index]}</span>\n                )}\n              </td>\n            ))}\n          </tr>\n        ))}\n      </tbody>\n      </table>\n      </div>\n      {sequence_selection_component}\n    </div>\n  );\n}\n\nfunction rescale_series(values, breaks) {\n  let min = 0, max = 1;\n  if (breaks) {\n    min = breaks[0];\n    max = breaks[breaks.length - 1];\n  }\n  return values.map((x) => (x - min) / (max - min));\n}\n\nfunction make_series_scale(breaks, breaks_width = \"8px\") {\n  // for now we ignore the range and use a default scale for everything\n  if (!breaks) {\n    breaks = [0, 0.5, 1];\n  }\n  let min = breaks[0];\n  let max = breaks[breaks.length - 1];\n  let breaks_rescaled = rescale_series(breaks, breaks);\n  return (\n    <>\n    {breaks_rescaled.map((x, i) => (\n      <div key={\"break-\"+i} style={{\"position\": \"absolute\", \"bottom\": `calc(${x * 100}% - 1px)`, \"width\": breaks_width, \"left\": `calc(100% - ${breaks_width})`, \"borderBottom\": \"0.5px solid black\"}}></div>\n    ))}\n    {breaks_rescaled.map((x, i) => (\n      <div key={\"breaklabel-\"+i} style={{\"position\": \"absolute\", \"bottom\": `${x * 100}%`, \"left\": `calc(100% - ${breaks_width} - 2px)`, \"lineHeight\": \"8px\", \"textAlign\": \"center\", \"transform\": `translate(-100%, ${x * 100}%)`}}>{breaks[i].toFixed(1)}</div>\n    ))}\n    <div style={{\"position\": \"absolute\", \"right\": \"0px\", \"bottom\": \"0px\", \"height\": \"100%\", \"width\": \"1px\", \"backgroundColor\": \"black\"}}></div>\n    </>\n  );\n}\n\nfunction make_color_scheme(alignment, scheme) {\n  const seqIds = Object.keys(alignment);\n  const aln_length = alignment[seqIds[0]].length;\n  const colors = {};\n  seqIds.forEach((id) => colors[id] = []);\n  for (let i = 0; i < aln_length; i++) {\n    let column = seqIds.map((id) => alignment[id][i]);\n    let column_colors = color_msa_column(column, scheme);\n    seqIds.forEach((id, index) => colors[id].push(column_colors[index]));\n  }\n  return colors;\n}\n\nfunction get_alignment_cumsum(alignment) {\n  const res = {};\n  for (const [key, val] of Object.entries(alignment)) {\n    res[key] = [];\n    let cumsum = 0;\n    for (let x of val) {\n      cumsum += (x === \"-\" ? 0 : 1);\n      res[key].push(cumsum);\n    }\n  }\n  return res;\n}\n\nfunction Seqselection({id, included, excluded, setIncluded, setExcluded}) {\n  // sortablejs needs items as objects with at least the `id` field.\n  const includedItems = make_sortablejs_items(included);\n  const excludedItems = make_sortablejs_items(excluded);\n  return (\n    <div className=\"seqselection\">\n      <div className=\"seqselection-included\">\n        <h3>Included sequences</h3>\n        <ReactSortable group={\"seqselection-\"+id} list={includedItems} setList={setIncluded} className=\"seqselection-sortable\">\n          {includedItems.map((item) => (<div key={item.id} className=\"seqselection-sortable-item\">{item.name}</div>))}\n        </ReactSortable>\n      </div>\n      <div className=\"seqselection-excluded\">\n        <h3>Excluded sequences</h3>\n        <ReactSortable group={\"seqselection-\"+id} list={excludedItems} setList={setExcluded} className=\"seqselection-sortable\">\n          {excluded.length ?\n            excludedItems.map((item) => (<div key={item.id} className=\"seqselection-sortable-item\">{item.name}</div>)) :\n            <p className=\"seqselection-message\">Drag and drop a sequence ID here to remove it from the alignment.</p>\n          }\n        </ReactSortable>\n      </div>\n    </div>\n  );\n}\n\nfunction make_sortablejs_items(l) {\n  return l.map((item) => ({\n    id: \"sortable-\"+item,\n    selected: false,\n    chosen: false,\n    filtered: false,\n    name: item,\n  }));\n}\n\nDashSeqaln.defaultProps = {};\n\nDashSeqaln.propTypes = {\n    /**\n     * The ID used to identify this component in Dash callbacks.\n     */\n    id: PropTypes.string,\n\n    /**\n     * A label that will be printed when this component is rendered.\n     */\n    title: PropTypes.string,\n\n    /**\n     * An object representing the MSA.\n     */\n    alignment: PropTypes.object,\n\n    /**\n     * List of objects, each containing the data for a bar plot.\n     */\n    series: PropTypes.array,\n\n    /**\n     * The color scheme for the alignment, from Jalview.\n     */\n    color_scheme: PropTypes.string,\n\n    /**\n     * Col number of the column to highlight.\n     */\n    highlightedCol: PropTypes.number,\n\n    /**\n     * Row number of the alignment to highlight.\n     */\n    highlightedRow: PropTypes.number,\n\n    /**\n     * List of sequence IDs to show in the alignment.\n     */\n    included: PropTypes.array,\n\n    /**\n     * List of sequence IDs to NOT show in the alignment.\n     */\n    excluded: PropTypes.array,\n\n    /**\n     * Dash-assigned callback that should be called to report property changes\n     * to Dash, to make them available for callbacks.\n     */\n    setProps: PropTypes.func\n};\n"],"sourceRoot":""}